<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Booking Website</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
        integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBxcGbtIQFIgaMtns+p/RHOvBBQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<body>
    <header>
        <div class="logo">
            <a href="#"> <img src="gjslogo.jpg" alt="GJ'S Beauty Lounge Logo">
            </a>
        </div>
        <div class="header-text">
            <h1>Nails, Facials, Brows, Lashes, Waxing, Gluta Spa <span>Clinic Hours: 9AM - 8PM</span></h1>
        </div>
        <nav>
            <ul>
                <li><a href="reviews.html">Reviews</a></li>
                <li><a href="faq.html">FAQ</a></li>
                <li><a href="services.html">Services</a></li>
                <li><a href="#" id="loginLink">Login</a></li>      <li><a href="#" id="registerLink">Register</a></li> </ul>
        </nav>
    </header>

    <main>
        <section class="hero">
            <div class="hero-left">
                <img src="1st hp.jpg" alt="Left Image" class="boxed-image">
            </div>
            <div class="hero-center">
                <img src="book.png" alt="Center Image" class="circular-image">
            </div>
            <div class="hero-right">
                <img src="2ndhp.jpg" alt="Right Image" class="boxed-image">
            </div>
        </section>
    </main>

    <footer>
        <div class="footer-section">
            <h3>More about Company</h3>
            <p>GJ's Beauty Lounge is dedicated to enhancing beauty and confidence through professional services, including
                nails, brows, lashes, waxing, and gluta spa treatments. With a commitment to quality and customer
                satisfaction, we create a relaxing space where clients can enjoy top-tier beauty care.</p>
        </div>
        <div class="footer-section">
            <h3>Keep Connected</h3>
            <div class="social-links">
                <a href="#" target="_blank"><i class="fab fa-facebook"></i> Facebook</a>
                <a href="#" target="_blank"><i class="fab fa-instagram"></i> Instagram</a>
            </div>
        </div>
        <div class="footer-section">
            <h3>Contact Information</h3>
            <p><i class="fas fa-map-marker-alt"></i> Lower Ground Floor, Nova Plaza Mall, Quirino Highway, Novaliches
                Proper, Quezon City</p>
            <p><i class="fas fa-phone"></i> 0962-847-2488</p>
            <p><i class="fas fa-envelope"></i> <a href="mailto:gjsbeautylounge@gmail.com">gjsbeautylounge@gmail.com</a></p>
        </div>
    </footer>

    <div id="registerModal" class="modal">
        <div class="modal-content register-modal-content">
            <span class="close-button register-close-button">&times;</span>
            <div class="modal-form-header">
                <img src="gjslogo.jpg" alt="GJ'S Logo" class="modal-form-logo">
                <h2 class="modal-form-title">Registration Form</h2>
            </div>
            <form id="registrationForm" class="modal-form-body">
                <div class="form-row">
                    <div class="form-group">
                        <label for="reg-lastname">Lastname:</label>
                        <input type="text" id="reg-lastname" name="lastname" placeholder="Lastname" required>
                    </div>
                    <div class="form-group">
                        <label for="reg-firstname">Firstname:</label>
                        <input type="text" id="reg-firstname" name="firstname" placeholder="Firstname" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="reg-email">Email:</label>
                        <input type="email" id="reg-email" name="email" placeholder="example@gmail.com" required>
                    </div>
                    <div class="form-group">
                        <label for="reg-contact">Contact No.:</label>
                        <input type="tel" id="reg-contact" name="contact" placeholder="+63 123 123 123" required>
                    </div>
                </div>
                <div class="form-group gender-group">
                    <label>Gender:</label>
                    <div class="radio-options">
                        <input type="radio" id="male" name="gender" value="male" required>
                        <label for="male">Male</label>
                        <input type="radio" id="female" name="gender" value="female">
                        <label for="female">Female</label>
                        <input type="radio" id="prefer-not" name="gender" value="prefer_not_say">
                        <label for="prefer-not">Prefer not to say</label>
                    </div>
                </div>
                <div class="form-group">
                    <label for="reg-username">Username:</label>
                    <input type="text" id="reg-username" name="username" placeholder="Username" required>
                </div>
                <div class="form-group">
                    <label for="reg-password">Password:</label>
                    <input type="password" id="reg-password" name="password" placeholder="Password" required>
                </div>
                <div class="form-group">
                    <label for="reg-confirm-password">Confirm Password:</label>
                    <input type="password" id="reg-confirm-password" name="confirm_password" placeholder="Password"
                        required>
                </div>
                <button type="submit">Register Now!</button>
                <p class="login-link">
                    Have already an account? <a href="#" id="switchToLogin">Login Here</a>
                </p>
            </form>
        </div>
    </div>

    <div id="loginModal" class="modal">
        <div class="modal-content login-modal-content">
            <span class="close-button login-close-button">&times;</span>
            <div class="modal-header login-modal-header">
                <img src="gjslogo.jpg" alt="GJ'S Logo" class="modal-form-logo">
                <h2 class="modal-form-title">Login Form</h2>
            </div>
            <div class="modal-form-body">
                <form id="loginForm">
                    <div class="form-group">
                        <label for="login-email-user">Email/Username:</label>
                        <input type="text" id="login-email-user" name="email_username" required>
                    </div>
                    <div class="form-group">
                        <label for="login-password">Password:</label>
                        <input type="password" id="login-password" name="password" required>
                    </div>
                    <button type="submit">Login</button>
                    <p class="register-link">
                        Don't have an Account? <a href="#" id="switchToRegister">Register here</a>
                    </p>
                </form>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-analytics.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-auth.js";
        import { getFirestore, collection, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-firestore.js";

        // --- Firebase Configuration ---
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY", // Replace with your actual API key - IMPORTANT: Keep this secure
            authDomain: "gjsbooking.firebaseapp.com",
            projectId: "gjsbooking",
            storageBucket: "gjsbooking.firebasestorage.app",
            messagingSenderId: "586636677275",
            appId: "1:586636677275:web:1a2385842e887db93bf63e",
            measurementId: "G-9XR9FMSE44"
        };

        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // --- Firebase Registration ---
        const registrationForm = document.getElementById('registrationForm');
        // ... (rest of your registration form variables) ...
        const emailInput = document.getElementById('reg-email');
        const passwordInput = document.getElementById('reg-password');
        const usernameInput = document.getElementById('reg-username');
        const firstnameInput = document.getElementById('reg-firstname');
        const lastnameInput = document.getElementById('reg-lastname');
        const contactInput = document.getElementById('reg-contact');
        const genderInputs = document.getElementsByName('gender');
        const registerButton = document.querySelector('#registrationForm button[type="submit"]');

        const registerMessage = document.createElement('p');
        registerMessage.classList.add('registration-message');
        registerMessage.style.cssText = "text-align: center; margin-top: 10px; font-weight: bold; color: blue;";
        if (registrationForm) {
            registrationForm.appendChild(registerMessage); // Append message area
        } else {
             console.error("Registration form not found!");
        }

        if (registrationForm) {
            registrationForm.addEventListener('submit', (event) => {
                event.preventDefault();

                if (registerButton) registerButton.disabled = true;
                registerMessage.textContent = "Registering...";

                const selectedGender = [...genderInputs].find(input => input.checked)?.value || "";

                const password = passwordInput ? passwordInput.value : '';
                const confirmPasswordInput = document.getElementById('reg-confirm-password');
                const confirmPassword = confirmPasswordInput ? confirmPasswordInput.value : '';

                // Basic Password Match Validation
                if (password !== confirmPassword) {
                    registerMessage.textContent = "Passwords do not match.";
                    registerMessage.style.color = "red";
                    if (registerButton) registerButton.disabled = false;
                    return; // Stop submission
                }

                registerUser(
                    emailInput ? emailInput.value : '',
                    password, // Use the validated password
                    usernameInput ? usernameInput.value : '',
                    firstnameInput ? firstnameInput.value : '',
                    lastnameInput ? lastnameInput.value : '',
                    contactInput ? contactInput.value : '',
                    selectedGender
                );
            });
        }

        async function registerUser(email, password, username, firstname, lastname, contact, gender) {
            // Check if required fields are provided
             if (!email || !password || !username || !firstname || !lastname || !contact || !gender) {
                registerMessage.textContent = "Please fill in all required fields.";
                registerMessage.style.color = "red";
                 if (registerButton) registerButton.disabled = false;
                return; // Stop registration if fields are missing
             }

            try {
                // --- Firebase Authentication ---
                const userCredential = await createUserWithEmailAndPassword(auth, email, password);
                const user = userCredential.user;
                console.log("Firebase Authentication successful. User UID:", user.uid);

                // --- Firestore ---
                const userDocRef = doc(collection(db, "users"), user.uid);
                await setDoc(userDocRef, {
                    email: email,
                    username: username,
                    firstname: firstname,
                    lastname: lastname,
                    contact: contact,
                    gender: gender,
                    createdAt: new Date()
                });
                console.log("Firestore data saved successfully for UID:", user.uid);

                registerMessage.textContent = "Registration successful!";
                registerMessage.style.color = "green";

                // Optional: Clear form or redirect after a short delay
                // registrationForm.reset();
                // setTimeout(() => { registerModal.style.display = 'none'; }, 2000);


            } catch (error) {
                console.error("Registration error:", error);
                let errorMessage = "Registration failed. Please try again.";
                if (error.code === 'auth/email-already-in-use') {
                    errorMessage = "This email is already in use.";
                } else if (error.code === 'auth/invalid-email') {
                    errorMessage = "Invalid email address.";
                } else if (error.code === 'auth/weak-password') {
                    errorMessage = "Password should be at least 6 characters.";
                }
                registerMessage.textContent = errorMessage;
                registerMessage.style.color = "red";

            } finally {
                 if (registerButton) registerButton.disabled = false;
            }
        }

        // --- Firebase Login ---
        const loginForm = document.getElementById('loginForm');
        const loginEmailInput = document.getElementById('login-email-user');
        const loginPasswordInput = document.getElementById('login-password');

         const loginMessage = document.createElement('p'); // Create message element for login
         loginMessage.classList.add('login-message');
         loginMessage.style.cssText = "text-align: center; margin-top: 10px; font-weight: bold; color: blue;";
        if (loginForm) {
             loginForm.appendChild(loginMessage); // Append it to the login form
            loginForm.addEventListener('submit', (event) => {
                event.preventDefault();
                 loginMessage.textContent = "Logging in..."; // Provide feedback
                loginMessage.style.color = "blue";
                loginUser(loginEmailInput.value, loginPasswordInput.value);
            });
        } else {
             console.error("Login form not found!");
        }


        async function loginUser(emailOrUsername, password) {
            // Simple check: In a real app, you might need to query Firestore
            // by username first if it's not an email format.
            // For simplicity, we'll assume email login for now.
             if (!emailOrUsername || !password) {
                 loginMessage.textContent = "Please enter email/username and password.";
                 loginMessage.style.color = "red";
                 return;
             }

            try {
                 // Assuming login is via email for this example
                const userCredential = await signInWithEmailAndPassword(auth, emailOrUsername, password);
                const user = userCredential.user;
                 loginMessage.textContent = "Login successful! Redirecting...";
                 loginMessage.style.color = "green";
                // Redirect after a short delay
                setTimeout(() => {
                    window.location.href = "dashboard.html"; // Redirect to dashboard
                }, 1500); // 1.5 second delay

            } catch (error) {
                console.error("Login error:", error.code, error.message);
                 let errorMessage = "Login failed. Please check your credentials.";
                if (error.code === 'auth/user-not-found' || error.code === 'auth/wrong-password' || error.code === 'auth/invalid-credential') {
                     errorMessage = "Invalid email/username or password.";
                } else if (error.code === 'auth/invalid-email') {
                     errorMessage = "Invalid email format entered.";
                 }
                 loginMessage.textContent = errorMessage;
                 loginMessage.style.color = "red";
            }
        }

        // --- Optional: Function to retrieve and display user data ---
        // (Keep this function as is if you need it)
        async function displayUserData(userId) {
            try {
                const userDocRef = doc(collection(db, "users"), userId);
                const docSnap = await getDoc(userDocRef);

                if (docSnap.exists()) {
                    const userData = docSnap.data();
                    console.log("User Data:", userData);
                    // Update UI here if needed
                } else {
                    console.log("No such document!");
                }
            } catch (error) {
                console.error("Error fetching user data:", error);
            }
        }

    </script>

    <script>
        // --- Modal Logic ---
        const loginLink = document.getElementById('loginLink');
        const registerLink = document.getElementById('registerLink');
        const loginModal = document.getElementById('loginModal');
        const registerModal = document.getElementById('registerModal');
        const loginCloseButton = loginModal ? loginModal.querySelector('.login-close-button') : null;
        const registerCloseButton = registerModal ? registerModal.querySelector('.register-close-button') : null;
        const switchToRegister = document.getElementById('switchToRegister');
        const switchToLogin = document.getElementById('switchToLogin');

        // Function to close all modals - good practice
        function closeAllModals() {
            if (registerModal) registerModal.style.display = "none";
            if (loginModal) loginModal.style.display = "none";
        }

        // Check if all elements were found before adding listeners
        if (loginLink && registerLink && loginModal && registerModal && loginCloseButton && registerCloseButton && switchToRegister && switchToLogin) {

            // Open Login Modal
            loginLink.addEventListener('click', (e) => {
                e.preventDefault(); // Prevent default link behavior
                closeAllModals();   // Close others first
                loginModal.style.display = 'block';
            });

            // Open Register Modal
            registerLink.addEventListener('click', (e) => {
                e.preventDefault();
                closeAllModals();
                registerModal.style.display = 'block';
            });

            // Close Login Modal via (X)
            loginCloseButton.addEventListener('click', () => {
                loginModal.style.display = 'none';
            });

            // Close Register Modal via (X)
            registerCloseButton.addEventListener('click', () => {
                registerModal.style.display = 'none';
            });

            // Close modal if background (outside content) is clicked
            window.addEventListener('click', (event) => {
                if (event.target === loginModal) {
                    loginModal.style.display = 'none';
                }
                if (event.target === registerModal) {
                    registerModal.style.display = 'none';
                }
            });

            // Switch from Login to Register Modal
            switchToRegister.addEventListener('click', (e) => {
                e.preventDefault();
                loginModal.style.display = 'none';
                registerModal.style.display = 'block';
            });

            // Switch from Register to Login Modal
            switchToLogin.addEventListener('click', (e) => {
                e.preventDefault();
                registerModal.style.display = 'none';
                loginModal.style.display = 'block';
            });

        } else {
            // Log an error if any essential element is missing
            console.error("Modal Error: One or more required elements (links, modals, buttons) not found in the HTML.");
        }
    </script>

</body>
</html>
